<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Stack Extens√£o - Editor Web</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            font-family: 'Fira Code', 'Monaco', 'Consolas', monospace;
            background: #1e1e1e;
            color: #d4d4d4;
            overflow: hidden;
        }
        
        .demo-header {
            background: #2d2d30;
            padding: 20px;
            text-align: center;
            border-bottom: 1px solid #3e3e42;
        }
        
        .demo-title {
            font-size: 2em;
            margin: 0;
            color: #4ec9b0;
        }
        
        .demo-subtitle {
            margin: 10px 0 0 0;
            color: #888;
        }
        
        .demo-features {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 20px;
            flex-wrap: wrap;
        }
        
        .feature-badge {
            background: #007acc;
            color: white;
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 0.9em;
        }
        
        .editor-container {
            height: calc(100vh - 200px);
            display: flex;
        }
        
        .code-panel {
            flex: 1;
            display: flex;
            flex-direction: column;
        }
        
        .code-header {
            background: #2d2d30;
            padding: 10px 20px;
            border-bottom: 1px solid #3e3e42;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .file-tabs {
            display: flex;
            gap: 5px;
        }
        
        .file-tab {
            background: #3e3e42;
            color: #d4d4d4;
            border: none;
            padding: 8px 16px;
            border-radius: 4px 4px 0 0;
            cursor: pointer;
        }
        
        .file-tab.active {
            background: #1e1e1e;
        }
        
        .editor-controls {
            display: flex;
            gap: 10px;
        }
        
        .btn {
            background: #007acc;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 4px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 5px;
        }
        
        .btn:hover {
            background: #005a9e;
        }
        
        .btn:disabled {
            background: #666;
            cursor: not-allowed;
        }
        
        .code-editor {
            flex: 1;
            background: #1e1e1e;
            color: #d4d4d4;
            border: none;
            padding: 20px;
            font-family: 'Fira Code', 'Monaco', 'Consolas', monospace;
            font-size: 14px;
            line-height: 1.5;
            resize: none;
            outline: none;
        }
        
        .output-panel {
            width: 400px;
            background: #252526;
            border-left: 1px solid #3e3e42;
            display: flex;
            flex-direction: column;
        }
        
        .output-tabs {
            display: flex;
            background: #2d2d30;
        }
        
        .output-tab {
            flex: 1;
            background: #3e3e42;
            color: #d4d4d4;
            border: none;
            padding: 10px;
            cursor: pointer;
        }
        
        .output-tab.active {
            background: #252526;
        }
        
        .output-content {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
        }
        
        .output-text {
            white-space: pre-wrap;
            font-family: 'Fira Code', 'Monaco', 'Consolas', monospace;
            font-size: 12px;
            line-height: 1.4;
        }
        
        .ai-suggestion {
            background: #2d2a1b;
            border-left: 4px solid #dcdcaa;
            padding: 10px;
            margin: 10px 0;
            border-radius: 4px;
        }
        
        .ai-suggestion.error {
            background: #2d1b1b;
            border-left-color: #f48771;
        }
        
        .ai-suggestion.info {
            background: #1b2d2d;
            border-left-color: #4ec9b0;
        }
        
        .collaborators {
            background: #2d2d30;
            padding: 10px;
            border-top: 1px solid #3e3e42;
        }
        
        .collaborator {
            display: flex;
            align-items: center;
            gap: 8px;
            margin: 5px 0;
        }
        
        .user-avatar {
            width: 24px;
            height: 24px;
            background: #007acc;
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            font-weight: bold;
        }
        
        .status-bar {
            background: #2d2d30;
            padding: 5px 20px;
            font-size: 12px;
            color: #888;
            display: flex;
            justify-content: space-between;
        }
        
        .hidden {
            display: none;
        }
    </style>
</head>
<body>
    <div class="demo-header">
        <h1 class="demo-title">üöÄ Stack Extens√£o</h1>
        <p class="demo-subtitle">A super linguagem de programa√ß√£o √∫nica!</p>
        <div class="demo-features">
            <span class="feature-badge">üåç C√≥digo Bil√≠ngue</span>
            <span class="feature-badge">üßÆ Operadores em Portugu√™s</span>
            <span class="feature-badge">ü§ñ IA Integrada</span>
            <span class="feature-badge">üî• Hot-reload</span>
            <span class="feature-badge">üë• Colabora√ß√£o</span>
            <span class="feature-badge">üåê Editor Web</span>
        </div>
    </div>
    
    <div class="editor-container">
        <div class="code-panel">
            <div class="code-header">
                <div class="file-tabs">
                    <button class="file-tab active" onclick="switchFile('main.stk')">main.stk</button>
                    <button class="file-tab" onclick="switchFile('utils.stk')">utils.stk</button>
                    <button class="file-tab" onclick="newFile()">+</button>
                </div>
                <div class="editor-controls">
                    <button class="btn" onclick="runCode()">
                        <span>‚ñ∂</span> Executar
                    </button>
                    <button class="btn" onclick="toggleLanguage()">
                        <span>üåê</span> <span id="lang-text">PT/EN</span>
                    </button>
                    <button class="btn" onclick="shareProject()">
                        <span>üîó</span> Compartilhar
                    </button>
                    <button class="btn" onclick="analyzeWithAI()">
                        <span>ü§ñ</span> Analisar IA
                    </button>
                </div>
            </div>
            <textarea id="code-editor" class="code-editor" placeholder="Digite seu c√≥digo Stack Extens√£o aqui..."></textarea>
            <div class="status-bar">
                <span id="language-indicator">Portugu√™s</span>
                <span id="line-info">Linha 1, Coluna 1</span>
                <span id="file-info">main.stk</span>
            </div>
        </div>
        
        <div class="output-panel">
            <div class="output-tabs">
                <button class="output-tab active" onclick="switchOutputTab('output')">Sa√≠da</button>
                <button class="output-tab" onclick="switchOutputTab('console')">Console</button>
                <button class="output-tab" onclick="switchOutputTab('ai')">IA</button>
                <button class="output-tab" onclick="switchOutputTab('collaborators')">Colaboradores</button>
            </div>
            <div class="output-content">
                <div id="output" class="output-text"></div>
                <div id="console" class="output-text hidden"></div>
                <div id="ai" class="hidden">
                    <div class="ai-suggestion info">
                        <strong>üí° Sugest√£o da IA:</strong>
                        <p>Seu c√≥digo est√° bem estruturado! Considere adicionar coment√°rios para melhor documenta√ß√£o.</p>
                    </div>
                    <div class="ai-suggestion">
                        <strong>‚ö° Otimiza√ß√£o:</strong>
                        <p>Para melhor performance, considere usar Array.from() em vez de loops tradicionais.</p>
                    </div>
                </div>
                <div id="collaborators" class="hidden">
                    <div class="collaborator">
                        <div class="user-avatar" style="background: #FF6B6B;">J</div>
                        <span>Jo√£o (Voc√™)</span>
                    </div>
                    <div class="collaborator">
                        <div class="user-avatar" style="background: #4ECDC4;">M</div>
                        <span>Maria</span>
                    </div>
                    <div class="collaborator">
                        <div class="user-avatar" style="background: #45B7D1;">P</div>
                        <span>Pedro</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Estado da aplica√ß√£o
        let currentFile = 'main.stk';
        let currentLanguage = 'portuguese';
        let files = {
            'main.stk': `// Bem-vindo ao Stack Extens√£o Editor!
// Digite seu c√≥digo aqui e pressione Ctrl+Enter para executar

funcao main() {
    imprimir("Ol√°, Stack Extens√£o!")
    
    variavel numeros = [1, 2, 3, 4, 5]
    variavel soma = 0
    
    para (variavel i = 0; i menor numeros.length; i = i mais 1) {
        soma = soma mais numeros[i]
    }
    
    imprimir("Soma dos n√∫meros: " + soma)
    
    // Demonstra√ß√£o de operadores em portugu√™s
    variavel resultado = 10 mais 5 vezes 2
    imprimir("10 mais 5 vezes 2 = " + resultado)
    
    // Demonstra√ß√£o de c√≥digo bil√≠ngue
    variavel englishResult = calculateSum(numeros)
    imprimir("English function result: " + englishResult)
}

// Fun√ß√£o em ingl√™s
function calculateSum(numbers) {
    let sum = 0
    for (let i = 0; i < numbers.length; i++) {
        sum = sum + numbers[i]
    }
    return sum
}

main()`,
            'utils.stk': `// Arquivo de utilit√°rios
funcao formatarNumero(numero) {
    retornar numero.toFixed(2)
}

funcao validarEmail(email) {
    variavel regex = /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/
    retornar regex.test(email)
}`
        };

        // Inicializar editor
        function initEditor() {
            const editor = document.getElementById('code-editor');
            editor.value = files[currentFile];
            
            editor.addEventListener('input', () => {
                files[currentFile] = editor.value;
                updateLineInfo();
            });
            
            editor.addEventListener('keydown', (e) => {
                if (e.ctrlKey && e.key === 'Enter') {
                    e.preventDefault();
                    runCode();
                }
            });
            
            updateLineInfo();
        }

        // Executar c√≥digo
        function runCode() {
            const code = document.getElementById('code-editor').value;
            const output = document.getElementById('output');
            
            // Simular execu√ß√£o
            output.innerHTML = 'Executando c√≥digo...\n';
            
            setTimeout(() => {
                try {
                    // Traduzir c√≥digo para JavaScript
                    const jsCode = translateToJavaScript(code);
                    
                    // Executar c√≥digo
                    const result = eval(jsCode);
                    
                    output.innerHTML = 'C√≥digo executado com sucesso!\n';
                    output.innerHTML += 'Resultado: ' + (result || 'undefined') + '\n';
                } catch (error) {
                    output.innerHTML = 'Erro na execu√ß√£o: ' + error.message + '\n';
                }
            }, 1000);
        }

        // Traduzir para JavaScript
        function translateToJavaScript(code) {
            return code
                .replace(/funcao/g, 'function')
                .replace(/variavel/g, 'var')
                .replace(/imprimir/g, 'console.log')
                .replace(/se/g, 'if')
                .replace(/senao/g, 'else')
                .replace(/enquanto/g, 'while')
                .replace(/para/g, 'for')
                .replace(/retornar/g, 'return')
                .replace(/mais/g, '+')
                .replace(/menos/g, '-')
                .replace(/vezes/g, '*')
                .replace(/dividido/g, '/')
                .replace(/elevado/g, '**')
                .replace(/modulo/g, '%')
                .replace(/igual/g, '===')
                .replace(/diferente/g, '!==')
                .replace(/maior/g, '>')
                .replace(/menor/g, '<')
                .replace(/maior_igual/g, '>=')
                .replace(/menor_igual/g, '<=')
                .replace(/e/g, '&&')
                .replace(/ou/g, '||')
                .replace(/nao/g, '!')
                .replace(/verdadeiro/g, 'true')
                .replace(/falso/g, 'false')
                .replace(/nulo/g, 'null')
                .replace(/vazio/g, 'undefined');
        }

        // Alternar idioma
        function toggleLanguage() {
            const code = document.getElementById('code-editor').value;
            const langText = document.getElementById('lang-text');
            const langIndicator = document.getElementById('language-indicator');
            
            if (currentLanguage === 'portuguese') {
                // Traduzir para ingl√™s
                const translated = translateToEnglish(code);
                document.getElementById('code-editor').value = translated;
                currentLanguage = 'english';
                langText.textContent = 'EN/PT';
                langIndicator.textContent = 'English';
            } else {
                // Traduzir para portugu√™s
                const translated = translateToPortuguese(code);
                document.getElementById('code-editor').value = translated;
                currentLanguage = 'portuguese';
                langText.textContent = 'PT/EN';
                langIndicator.textContent = 'Portugu√™s';
            }
        }

        // Traduzir para ingl√™s
        function translateToEnglish(code) {
            return code
                .replace(/funcao/g, 'function')
                .replace(/variavel/g, 'var')
                .replace(/imprimir/g, 'console.log')
                .replace(/se/g, 'if')
                .replace(/senao/g, 'else')
                .replace(/enquanto/g, 'while')
                .replace(/para/g, 'for')
                .replace(/retornar/g, 'return')
                .replace(/mais/g, '+')
                .replace(/menos/g, '-')
                .replace(/vezes/g, '*')
                .replace(/dividido/g, '/')
                .replace(/elevado/g, '**')
                .replace(/modulo/g, '%')
                .replace(/igual/g, '===')
                .replace(/diferente/g, '!==')
                .replace(/maior/g, '>')
                .replace(/menor/g, '<')
                .replace(/maior_igual/g, '>=')
                .replace(/menor_igual/g, '<=')
                .replace(/e/g, '&&')
                .replace(/ou/g, '||')
                .replace(/nao/g, '!')
                .replace(/verdadeiro/g, 'true')
                .replace(/falso/g, 'false')
                .replace(/nulo/g, 'null')
                .replace(/vazio/g, 'undefined');
        }

        // Traduzir para portugu√™s
        function translateToPortuguese(code) {
            return code
                .replace(/function/g, 'funcao')
                .replace(/var/g, 'variavel')
                .replace(/console\.log/g, 'imprimir')
                .replace(/if/g, 'se')
                .replace(/else/g, 'senao')
                .replace(/while/g, 'enquanto')
                .replace(/for/g, 'para')
                .replace(/return/g, 'retornar')
                .replace(/\+/g, 'mais')
                .replace(/-/g, 'menos')
                .replace(/\*/g, 'vezes')
                .replace(/\//g, 'dividido')
                .replace(/\*\*/g, 'elevado')
                .replace(/%/g, 'modulo')
                .replace(/===/g, 'igual')
                .replace(/!==/g, 'diferente')
                .replace(/>/g, 'maior')
                .replace(/</g, 'menor')
                .replace(/>=/g, 'maior_igual')
                .replace(/<=/g, 'menor_igual')
                .replace(/&&/g, 'e')
                .replace(/\|\|/g, 'ou')
                .replace(/!/g, 'nao')
                .replace(/true/g, 'verdadeiro')
                .replace(/false/g, 'falso')
                .replace(/null/g, 'nulo')
                .replace(/undefined/g, 'vazio');
        }

        // Analisar com IA
        function analyzeWithAI() {
            const code = document.getElementById('code-editor').value;
            const aiPanel = document.getElementById('ai');
            
            aiPanel.innerHTML = '<div class="ai-suggestion info"><strong>ü§ñ Analisando c√≥digo com IA...</strong></div>';
            
            setTimeout(() => {
                const suggestions = generateAISuggestions(code);
                let html = '';
                
                suggestions.forEach(suggestion => {
                    html += `<div class="ai-suggestion ${suggestion.type}">
                        <strong>${suggestion.title}</strong>
                        <p>${suggestion.message}</p>
                    </div>`;
                });
                
                aiPanel.innerHTML = html;
            }, 1500);
        }

        // Gerar sugest√µes da IA
        function generateAISuggestions(code) {
            const suggestions = [];
            
            if (code.includes('funcao') && !code.includes('retornar')) {
                suggestions.push({
                    type: 'warning',
                    title: '‚ö†Ô∏è Fun√ß√£o sem retorno',
                    message: 'Considere adicionar um retornar no final da fun√ß√£o'
                });
            }
            
            if (code.includes('dividido') && !code.includes('se') && !code.includes('diferente 0')) {
                suggestions.push({
                    type: 'error',
                    title: '‚ùå Poss√≠vel divis√£o por zero',
                    message: 'Adicione verifica√ß√£o antes da divis√£o'
                });
            }
            
            if (code.includes('para') && code.includes('imprimir')) {
                suggestions.push({
                    type: 'info',
                    title: 'üí° Otimiza√ß√£o dispon√≠vel',
                    message: 'Considere usar console.log com array para melhor performance'
                });
            }
            
            if (suggestions.length === 0) {
                suggestions.push({
                    type: 'info',
                    title: '‚úÖ C√≥digo analisado',
                    message: 'Nenhum problema encontrado! Seu c√≥digo est√° bem estruturado.'
                });
            }
            
            return suggestions;
        }

        // Trocar arquivo
        function switchFile(fileName) {
            currentFile = fileName;
            document.getElementById('code-editor').value = files[fileName] || '';
            
            // Atualizar tabs
            document.querySelectorAll('.file-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            event.target.classList.add('active');
            
            // Atualizar info do arquivo
            document.getElementById('file-info').textContent = fileName;
        }

        // Novo arquivo
        function newFile() {
            const fileName = prompt('Nome do arquivo:', 'novo.stk');
            if (fileName) {
                files[fileName] = '';
                // Adicionar tab (implementa√ß√£o simplificada)
                console.log('Novo arquivo criado:', fileName);
            }
        }

        // Trocar aba de sa√≠da
        function switchOutputTab(tabName) {
            // Remover active de todas as tabs
            document.querySelectorAll('.output-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            
            document.querySelectorAll('.output-content > div').forEach(content => {
                content.classList.add('hidden');
            });

            // Ativar tab selecionada
            event.target.classList.add('active');
            document.getElementById(tabName).classList.remove('hidden');
        }

        // Compartilhar projeto
        function shareProject() {
            const projectData = {
                files: files,
                theme: 'dark',
                language: currentLanguage,
                timestamp: Date.now()
            };

            const encoded = btoa(JSON.stringify(projectData));
            const shareUrl = `${window.location.origin}?project=${encoded}`;
            
            navigator.clipboard.writeText(shareUrl).then(() => {
                alert('Link de compartilhamento copiado!\n' + shareUrl);
            });
        }

        // Atualizar info da linha
        function updateLineInfo() {
            const editor = document.getElementById('code-editor');
            const text = editor.value;
            const lines = text.split('\n');
            const cursorPos = editor.selectionStart;
            const beforeCursor = text.substring(0, cursorPos);
            const line = beforeCursor.split('\n').length;
            const column = beforeCursor.split('\n').pop().length + 1;

            document.getElementById('line-info').textContent = `Linha ${line}, Coluna ${column}`;
        }

        // Inicializar quando a p√°gina carregar
        document.addEventListener('DOMContentLoaded', initEditor);
    </script>
</body>
</html>